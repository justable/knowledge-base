# 从一个案例谈谈组件封装

## 案例

一个砸金蛋页面，页面的交互主体有金蛋，锤子，报幕，现在就谈谈这个报幕组件如何封装。

## 报幕

1. 清晰实现效果：每次锤子砸开金蛋，产生一条数据给报幕，然后报幕对数据源进行循环播报
2. 建立数据结构与视图之间的关系：数据源是中奖信息的列表，视图需要展示 8 条数据并自动播报，比如以滚动的方式，那么就可以利用滑动窗口从数据源获取下次要展示的数据
3. 思考哪些节点可以暴露给使用者自定义：比如视图一次所展示的数据条数，滚动间隔，滚动速度，是否自动滚动，每条数据的自定义渲染函数，进一步的是否可以把动画类型也定制化，比如支持滚动或 fade 渐隐，然后在动画容器节点配置不同的动画 class，最后写好 props 的 TS 接口
4. 实现阶段：注意边界情况，比如数据源总条数是否小于视图所展示的条数，数据替换时机得在动画结束后替换用户才不会感知到
5. 单元测试：检验这个组件是否对单元测试友好，是否容易被单测也是一个组件逻辑是否恰当的判断依据，继而进一步完善代码实现，主要测输入源是否渲染预期结构
